<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProAnthem - Your Band's Digital Command Center</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
    <style>
        #auth-modal input {
            background-color: #1f2937;
            border: 1px solid #4b5563;
        }
    </style>
</head>
<body class="marketing flex flex-col min-h-screen">

    <header class="container mx-auto p-6 flex justify-between items-center">
        <a href="/proanthem_index.html" class="flex items-center space-x-4">
            <img src="/assets/logo_pa.jpg" alt="ProAnthem Logo" class="h-12">
            <h1 class="text-4xl font-bold">ProAnthem</h1>
        </a>
        <div id="nav-auth-section">
            <!-- Populated by auth script -->
        </div>
    </header>

    <main class="flex-grow">
        <section class="text-center py-20 px-6">
            <div class="container mx-auto">
                <h2 class="text-5xl md:text-7xl font-extrabold tracking-tight">
                    Your Band's <span class="headline-gradient">Stage-Ready Command Center.</span>
                </h2>
                <p class="mt-6 max-w-3xl mx-auto text-lg md:text-xl text-gray-300">
                    From the writer's room to the main stage, ProAnthem is the professional toolkit for Christian rock bands. Tame the chaos of complex songs, build powerful setlists, and keep every member perfectly in sync. It's time to unleash your sound.
                </p>
                <div class="mt-8 flex flex-col sm:flex-row items-center justify-center gap-4">
                    <a href="/pricing.html" class="btn btn-primary w-full sm:w-auto font-bold text-lg rounded-full py-4 px-10">
                        View Plans & Start 3-Day Trial
                    </a>
                    <a href="/demo.html" class="btn btn-secondary w-full sm:w-auto font-bold text-lg rounded-full py-4 px-10">
                        Try a Live Demo
                    </a>
                </div>
            </div>
        </section>

        <section id="features" class="py-20 px-6 bg-gray-900">
            <div class="container mx-auto">
                <div class="text-center mb-16">
                    <h3 class="text-4xl font-bold">From Rehearsal Room to the Main Stage</h3>
                    <p class="mt-4 text-lg text-gray-400 max-w-3xl mx-auto">
                        ProAnthem streamlines your entire creative process with powerful, purpose-built tools for every musician in the band.
                    </p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-12 text-center">
                     <div class="flex flex-col items-center">
                        <div class="feature-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 18V5l12-2v13M9 18c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2z" /><path stroke-linecap="round" stroke-linejoin="round" d="M12 13c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM21 12c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2z" /></svg>
                        </div>
                        <h4 class="text-2xl font-bold">Built for the Whole Band</h4>
                        <p class="mt-2 text-gray-400">
                           Write intricate riffs and solos with the interactive Guitar Tab editor and lock in the rhythm section with clean text-based Drum Tabs.
                        </p>
                    </div>
                    <div class="flex flex-col items-center">
                        <div class="feature-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
                        </div>
                        <h4 class="text-2xl font-bold">Pro Songwriting</h4>
                        <p class="mt-2 text-gray-400">
                            Handle complex arrangements with multi-section song building. Transpose keys instantly and keep everyone on the same page.
                        </p>
                    </div>
                    <div class="flex flex-col items-center">
                        <div class="feature-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 6l12-3" /></svg>
                        </div>
                        <h4 class="text-2xl font-bold">Gig-Ready Setlists</h4>
                        <p class="mt-2 text-gray-400">
                            Build and reorder your setlists in seconds. Perfect for tours, festivals, and weekend services. Print professional PDF packets for the whole band.
                        </p>
                    </div>
                    <div class="flex flex-col items-center">
                        <div class="feature-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z" /></svg>
                        </div>
                        <h4 class="text-2xl font-bold">Capture Ideas Instantly</h4>
                        <p class="mt-2 text-gray-400">
                            Inspiration strikes anywhere. Record a quick voice memo or riff directly onto a song's lyric sheet. Never lose a great idea again.
                        </p>
                    </div>
                </div>
            </div>
        </section>

         <section class="text-center py-20 px-6">
            <div class="container mx-auto">
                <h3 class="text-4xl font-bold">Ready to Organize Your Music?</h3>
                 <p class="mt-4 text-lg text-gray-400 max-w-2xl mx-auto">
                    Spend less time managing files and more time making music. Create your account and get instant access to the entire ProAnthem toolkit.
                </p>
                <div class="mt-8">
                    <a href="/pricing.html" class="btn btn-primary font-bold text-lg rounded-full py-4 px-10">
                        Start Your Free Trial Now
                    </a>
                </div>
            </div>
        </section>

        <section id="contact" class="py-20 px-6 bg-gray-900">
            <div class="container mx-auto max-w-3xl">
                <div class="text-center mb-12">
                    <h3 class="text-4xl font-bold">Have a Question?</h3>
                    <p class="mt-4 text-lg text-gray-400">
                        We'd love to hear from you. Fill out the form below and we'll get back to you as soon as possible.
                    </p>
                </div>
                
                <form id="contact-form" action="https://formspree.io/f/xpwjbkqg" method="POST" class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <input type="text" name="name" id="name" required class="form-input" placeholder="Your Name">
                        <input type="email" name="email" id="email" required class="form-input" placeholder="Your Email">
                    </div>
                    <div>
                        <input type="hidden" name="_subject" value="New ProAnthem Contact Form Submission!">
                        <textarea name="message" id="message" required rows="5" class="form-input" placeholder="Your Message"></textarea>
                    </div>
                    <input type="text" name="_gotcha" style="display:none">
                    <div class="text-center">
                        <button type="submit" id="contact-submit-button" class="btn btn-primary px-8 py-3">
                            Send Message
                        </button>
                    </div>
                </form>
                <p id="contact-status" class="text-center mt-6 h-6"></p>
            </div>
        </section>
    </main>

    <footer class="text-center py-6 text-gray-500">
        <p>&copy; 2025 ProAnthem. A Spreadsheet Simplicity Product.</p>
    </footer>

    <div id="auth-modal" class="modal-overlay hidden">
        <div class="bg-gray-900 rounded-lg shadow-xl p-8 m-4 max-w-md w-full" role="dialog" aria-modal="true">
            <button id="close-modal-button" class="absolute top-4 right-4 text-gray-500 hover:text-white text-2xl">&times;</button>
            <div id="login-view">
                <h2 class="text-3xl font-bold text-center mb-6 text-white">Log In to ProAnthem</h2>
                <form id="login-form" class="space-y-6">
                    <input id="login-email" name="email" type="email" required placeholder="Email address" class="form-input">
                    <input id="login-password" name="password" type="password" required placeholder="Password" class="form-input">
                    <button type="submit" class="btn btn-primary w-full py-3">Log In</button>
                </form>
                <p id="login-error" class="text-red-500 text-sm mt-4 text-center h-5"></p>
                <p class="text-center text-sm text-gray-400 mt-4">Don't have an account? <a href="/pricing.html" class="font-medium text-indigo-400 hover:text-indigo-300">Sign up here</a></p>
            </div>
        </div>
    </div>

    <!-- This script handles generic auth tasks like the nav bar -->
    <script type="module" src="/js/auth.js"></script>
    
    <!-- This script ONLY handles the logic for this specific page -->
    <script type="module">
        import { getUserPayload } from './js/auth.js';
        import { login } from './js/api.js';

        // --- LOGIN MODAL LOGIC ---
        const authModal = document.getElementById('auth-modal');
        const closeModalButton = document.getElementById('close-modal-button');
        const loginForm = document.getElementById('login-form');
        const loginError = document.getElementById('login-error');

        const closeModal = () => {
            if (authModal) {
                authModal.classList.add('hidden');
                authModal.classList.remove('flex');
            }
        };

        closeModalButton.addEventListener('click', closeModal);
        authModal.addEventListener('click', (e) => { 
            if (e.target === authModal) closeModal(); 
        });
        loginForm.addEventListener('submit', handleLogin);

        async function performLogin(credentials, redirectTo = null) {
            try {
                const result = await login(credentials);
                if (result.token) {
                    localStorage.setItem('user_token', result.token);
                    if (redirectTo) {
                        window.location.href = redirectTo;
                        return;
                    }
                    // After a successful login, check access to determine where to go.
                    // We must re-get the payload from the new token.
                    const user = getUserPayload();
                    const specialRoles = ['admin', 'band_admin', 'band_member'];
                    const validStatuses = ['active', 'trialing', 'admin_granted'];
                    const hasSpecialRole = user && specialRoles.includes(user.role);
                    const hasValidSubscription = user && validStatuses.includes(user.subscription_status);
                    const hasAccess = hasSpecialRole || hasValidSubscription;
                    window.location.href = hasAccess ? '/ProjectAnthem.html' : '/pricing.html';
                } else {
                    throw new Error("Login failed: No token returned.");
                }
            } catch (error) {
                throw error; // Re-throw to be caught by handleLogin
            }
        }

        async function handleLogin(event) {
            event.preventDefault();
            loginError.textContent = 'Logging in...';
            const payload = {
                email: loginForm.querySelector('#login-email').value,
                password: loginForm.querySelector('#login-password').value
            };
            try {
                await performLogin(payload);
            } catch(error) {
                // Now this will correctly display the error in the modal
                loginError.textContent = error.message;
            }
        }

        // --- CONTACT FORM LOGIC ---
        const contactForm = document.getElementById('contact-form');
        const contactStatus = document.getElementById('contact-status');
        async function handleContactSubmit(event) {
            event.preventDefault();
            const form = event.target;
            const data = new FormData(form);
            contactStatus.textContent = 'Sending...';
            try {
                const response = await fetch(form.action, {
                    method: form.method,
                    body: data,
                    headers: { 'Accept': 'application/json' }
                });
                if (response.ok) {
                    contactStatus.textContent = "Thanks for your message!";
                    contactStatus.style.color = '#4ade80';
                    form.reset();
                } else {
                    contactStatus.textContent = "Oops! There was a problem.";
                    contactStatus.style.color = '#f87171';
                }
            } catch (error) {
                contactStatus.textContent = "Oops! A network error occurred.";
                contactStatus.style.color = '#f87171';
            }
        }
        contactForm.addEventListener("submit", handleContactSubmit);
    </script>
</body>
</html>
